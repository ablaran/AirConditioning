#include <furi.h>
#include <gui/gui.h>
#include <gui/view_port.h>
#include <gui/canvas.h>
#include <input/input.h>
#include <infrared.h>
#include <infrared_signal.h>
#include <infrared_transmit.h>

/* generated by fbt from .png files in images folder */
#include <airconditioning_icons.h>

#define GRID_ROWS 2
#define GRID_COLS 3

int selected_row = 1; // Currently selected row in the grid
int selected_col = 0; // Currently selected column in the grid

// Structure representing each button in the grid UI
typedef struct {
    int x; // X coordinate for icon placement
    int y; // Y coordinate for icon placement
    const Icon* icon_light; // Icon shown when not selected
    const Icon* icon_dark; // Icon shown when selected (highlighted)
} GridButton;

GridButton grid[GRID_ROWS][GRID_COLS] = {
    {
        {22, 11, &I_dehumidifier_20x19, &I_dehumidifier_over_20x19}, //dehumidifier button
        {48, 11, &I_20_degree_20x19, &I_20_degree_over_20x19}, //20 degree button
        {74, 11, &I_24_degree_20x19, &I_24_degree_over_20x19} //24 degree button
    },
    {
        {22, 32, &I_power_20x19, &I_power_hover_20x19}, //power button
        {48, 32, &I_18_degree_20x19, &I_18_degree_over20x19}, //18 degree button
        {74, 32, &I_22_degree_20x19, &I_22_degree_over_20x19} //22 degree button
    }};

// Draw the main UI grid with icons, highlighting the selected button
static void draw_callback(Canvas* canvas, void* ctx) {
    UNUSED(ctx);

    canvas_draw_icon(canvas, 0, 0, &I_background_128x64);

    for(int row = 0; row < GRID_ROWS; row++) {
        for(int col = 0; col < GRID_COLS; col++) {
            GridButton* btn = &grid[row][col];

            bool selected = (row == selected_row && col == selected_col);

            // Draw icon dark if selected, light otherwise
            const Icon* icon = selected ? btn->icon_dark : btn->icon_light;
            canvas_draw_icon(canvas, btn->x, btn->y, icon);
        }
    }
}

//ir raw signals
static uint32_t ir_on_raw[] = {
    446,  417,  446, 417,   446,  417,  446, 419,  444, 418,  445, 25406, 3421, 1761, 443, 1283,
    444,  417,  446, 418,   445,  418,  445, 1282, 445, 418,  445, 419,   444,  418,  445, 418,
    445,  1282, 445, 418,   445,  1281, 446, 1282, 444, 419,  444, 1281,  446,  1282, 445, 1281,
    445,  1282, 445, 1282,  444,  418,  444, 418,  445, 1282, 445, 418,   445,  418,  445, 418,
    445,  418,  445, 418,   445,  418,  445, 418,  445, 418,  445, 419,   444,  420,  443, 1282,
    445,  417,  446, 1282,  445,  419,  444, 418,  445, 420,  443, 1283,  444,  1282, 444, 417,
    445,  419,  444, 418,   445,  419,  444, 418,  445, 418,  445, 419,   444,  419,  444, 419,
    444,  418,  445, 419,   444,  418,  445, 418,  445, 418,  445, 419,   444,  419,  444, 1283,
    444,  1282, 445, 1281,  445,  418,  445, 1281, 446, 418,  445, 1282,  445,  1281, 446, 34851,
    3420, 1760, 444, 1281,  446,  418,  444, 418,  445, 418,  445, 1283,  444,  418,  445, 419,
    444,  419,  444, 418,   445,  1283, 444, 418,  445, 1282, 445, 1282,  444,  418,  445, 1282,
    445,  1281, 446, 1282,  444,  1282, 444, 1282, 444, 418,  445, 419,   444,  1282, 445, 418,
    445,  418,  445, 419,   444,  419,  443, 419,  444, 419,  444, 418,   444,  419,  420, 444,
    444,  418,  445, 419,   444,  1283, 444, 418,  445, 419,  444, 418,   420,  443,  420, 1308,
    443,  420,  442, 420,   419,  444,  419, 443,  420, 444,  419, 443,   420,  444,  419, 444,
    419,  444,  419, 444,   419,  444,  419, 444,  419, 444,  419, 444,   419,  444,  419, 444,
    419,  444,  419, 444,   419,  443,  420, 1307, 419, 444,  419, 1308,  443,  420,  418, 1307,
    444,  420,  418, 34877, 3421, 1759, 444, 1282, 445, 418,  445, 420,   418,  444,  444, 1283,
    444,  419,  444, 419,   444,  418,  445, 419,  419, 1307, 445, 419,   443,  1282, 445, 1282,
    445,  418,  445, 1283,  444,  1283, 443, 1283, 444, 1281, 445, 1283,  444,  419,  443, 419,
    444,  1283, 444, 418,   444,  419,  419, 444,  443, 419,  420, 444,   419,  443,  420, 444,
    419,  443,  444, 419,   419,  444,  419, 443,  420, 444,  419, 443,   420,  444,  419, 444,
    419,  444,  419, 443,   420,  444,  419, 1308, 443, 418,  420, 444,   419,  1308, 444, 1282,
    444,  1282, 445, 418,   420,  443,  420, 444,  419, 444,  419, 1307,  445,  419,  419, 443,
    420,  1307, 444, 419,   419,  444,  419, 444,  419, 444,  419, 444,   419,  444,  419, 443,
    420,  444,  419, 444,   419,  445,  418, 1307, 444, 1283, 443, 1283,  444,  1282, 444, 1281,
    445,  1282, 445, 1283,  444,  419,  419, 1307, 445, 1283, 444, 1283,  443,  1283, 443, 418,
    420,  444,  419, 444,   419,  445,  418, 444,  419, 444,  419, 444,   419,  443,  420, 444,
    419,  444,  419, 444,   419,  443,  420, 444,  419, 1307, 444, 1283,  443,  419,  419, 444,
    419,  444,  419, 444,   419,  445,  418, 445,  418, 444,  419, 443,   420,  444,  419, 444,
    419,  1308, 443, 1283,  444,  419,  419, 444,  419, 444,  419, 444,   419,  444,  419, 444,
    419,  443,  420, 444,   419,  444,  419, 444,  419, 444,  419, 444,   419,  444,  419, 444,
    419,  444,  419, 444,   419,  445,  418, 443,  420, 444,  419, 444,   419,  444,  419, 444,
    419,  444,  419, 1307,  420,  1307, 420, 444,  419, 444,  419, 444,   419,  444,  419, 444,
    419,  444,  419, 445,   418,  444,  419, 444,  419, 443,  420, 444,   419,  445,  418, 444,
    419,  444,  419, 444,   419,  444,  419, 1308, 419, 1307, 420, 444,   419,  444,  419, 443,
    420,  1308, 419, 444,   419,  444,  419};
static uint32_t ir_off_raw[] = {
    417,  444,  419, 445,   418,  445,  418, 446,  417, 445,  418, 25432, 3420, 1759, 419, 1308,
    418,  445,  418, 445,   418,  444,  419, 1309, 418, 444,  419, 444,   419,  445,  418, 445,
    418,  1309, 417, 444,   419,  1309, 418, 1310, 416, 445,  418, 1308,  419,  1309, 417, 1309,
    417,  1308, 418, 1307,  419,  445,  418, 444,  419, 1309, 418, 445,   418,  446,  417, 444,
    419,  445,  418, 446,   417,  445,  418, 446,  417, 445,  418, 445,   418,  445,  418, 1309,
    418,  445,  418, 1309,  418,  445,  418, 446,  417, 445,  418, 1308,  419,  1307, 419, 446,
    417,  445,  418, 446,   417,  445,  418, 446,  417, 446,  417, 444,   419,  446,  417, 446,
    417,  445,  418, 446,   417,  446,  417, 445,  418, 445,  418, 445,   418,  445,  418, 1309,
    417,  1309, 417, 1309,  417,  444,  419, 1308, 419, 444,  419, 1309,  418,  1309, 417, 34876,
    3420, 1761, 417, 1308,  418,  444,  419, 444,  419, 445,  418, 1310,  417,  445,  418, 446,
    417,  445,  418, 445,   418,  1308, 418, 446,  417, 1309, 418, 1308,  418,  445,  418, 1308,
    418,  1307, 419, 1308,  419,  1308, 418, 1309, 417, 445,  418, 444,   419,  1309, 417, 445,
    418,  445,  418, 445,   418,  445,  418, 445,  418, 446,  417, 445,   418,  445,  418, 445,
    418,  445,  418, 445,   418,  1309, 417, 446,  417, 444,  419, 444,   419,  444,  419, 1309,
    418,  445,  418, 445,   418,  445,  418, 445,  418, 445,  418, 445,   418,  445,  418, 445,
    418,  445,  418, 445,   418,  445,  418, 445,  418, 446,  417, 445,   418,  445,  418, 445,
    418,  445,  418, 444,   419,  445,  418, 1309, 418, 445,  418, 1309,  418,  445,  418, 1309,
    417,  445,  418, 34875, 3420, 1760, 418, 1308, 418, 444,  419, 445,   418,  445,  418, 1309,
    418,  445,  418, 444,   419,  444,  419, 446,  417, 1309, 418, 444,   419,  1308, 418, 1308,
    419,  444,  419, 1308,  419,  1308, 418, 1308, 418, 1309, 417, 1309,  417,  445,  418, 446,
    417,  1309, 418, 445,   418,  445,  418, 445,  418, 445,  418, 445,   418,  445,  418, 445,
    418,  445,  418, 444,   419,  445,  418, 445,  418, 445,  418, 445,   418,  446,  417, 445,
    418,  445,  418, 446,   417,  444,  419, 446,  417, 446,  417, 444,   419,  1309, 418, 1308,
    418,  1308, 418, 445,   418,  445,  418, 446,  417, 445,  418, 1309,  418,  445,  418, 445,
    418,  1309, 418, 445,   418,  445,  418, 445,  418, 445,  418, 446,   417,  445,  418, 445,
    418,  444,  419, 444,   419,  445,  418, 1308, 418, 1310, 417, 1309,  417,  1309, 417, 1308,
    419,  1308, 418, 1309,  417,  445,  418, 1309, 418, 1309, 417, 1308,  418,  1308, 418, 446,
    417,  445,  418, 445,   418,  445,  418, 445,  418, 445,  418, 445,   418,  445,  418, 445,
    418,  445,  418, 446,   417,  445,  418, 445,  418, 1310, 417, 1309,  417,  445,  418, 445,
    418,  446,  417, 445,   418,  445,  418, 445,  418, 445,  418, 445,   418,  445,  418, 445,
    418,  1308, 419, 1308,  418,  445,  418, 446,  417, 446,  417, 446,   417,  445,  418, 445,
    418,  445,  418, 445,   418,  446,  417, 445,  418, 445,  418, 445,   418,  445,  418, 445,
    418,  446,  417, 446,   417,  445,  418, 446,  417, 445,  418, 445,   418,  445,  418, 445,
    418,  446,  417, 1309,  418,  1309, 417, 445,  418, 445,  418, 446,   417,  445,  418, 446,
    417,  446,  417, 446,   417,  445,  418, 445,  418, 445,  418, 445,   418,  445,  418, 446,
    417,  446,  417, 445,   418,  446,  417, 445,  418, 1309, 418, 445,   417,  446,  417, 445,
    418,  1309, 417, 445,   418,  445,  418};
static uint32_t ir_18_raw[] = {
    418,  445,  418, 443,   420,  443,  420, 444,  419, 443,  420, 25433, 3419, 1760, 419, 1307,
    420,  443,  420, 444,   419,  444,  419, 1308, 419, 444,  419, 442,   421,  444,  419, 443,
    420,  1306, 420, 443,   420,  1307, 420, 1306, 421, 443,  420, 1307,  420,  1306, 420, 1307,
    420,  1306, 420, 1307,  419,  444,  419, 444,  419, 1308, 419, 444,   419,  443,  420, 443,
    420,  443,  420, 444,   419,  443,  420, 444,  419, 444,  419, 443,   420,  444,  419, 1307,
    420,  444,  419, 1307,  420,  444,  419, 443,  420, 443,  420, 1308,  418,  1306, 420, 443,
    420,  443,  420, 444,   419,  443,  420, 444,  419, 443,  420, 443,   420,  444,  419, 443,
    420,  443,  420, 444,   419,  443,  420, 444,  419, 443,  420, 444,   419,  443,  420, 1307,
    420,  1307, 419, 1308,  419,  443,  420, 1307, 420, 443,  420, 1306,  420,  1307, 419, 34877,
    3420, 1760, 419, 1306,  420,  443,  420, 443,  420, 443,  420, 1307,  420,  444,  419, 444,
    419,  443,  420, 444,   419,  1308, 419, 443,  420, 1307, 420, 1306,  420,  443,  420, 1307,
    419,  1309, 417, 1307,  419,  1308, 419, 1308, 419, 443,  420, 444,   419,  1306, 421, 443,
    420,  443,  420, 443,   420,  443,  420, 443,  420, 444,  419, 444,   419,  443,  420, 444,
    419,  443,  420, 443,   420,  1307, 420, 443,  420, 444,  419, 443,   420,  444,  419, 1307,
    419,  444,  419, 443,   420,  444,  419, 444,  419, 443,  420, 444,   419,  443,  420, 444,
    419,  444,  419, 443,   420,  443,  420, 444,  419, 443,  420, 443,   420,  444,  419, 443,
    420,  443,  420, 443,   420,  443,  420, 1307, 420, 444,  419, 1307,  420,  443,  420, 1307,
    420,  444,  419, 34876, 3421, 1760, 419, 1307, 420, 444,  419, 444,   419,  443,  420, 1307,
    420,  443,  420, 444,   419,  443,  420, 443,  420, 1307, 420, 443,   420,  1308, 419, 1307,
    419,  444,  419, 1307,  419,  1309, 417, 1307, 420, 1307, 419, 1307,  419,  443,  420, 444,
    419,  1307, 420, 444,   419,  443,  420, 443,  420, 444,  419, 443,   420,  443,  420, 443,
    420,  443,  420, 444,   419,  444,  419, 443,  420, 443,  420, 443,   420,  444,  419, 443,
    420,  443,  420, 444,   419,  443,  420, 1306, 421, 444,  419, 443,   420,  1307, 419, 1307,
    420,  1307, 419, 443,   420,  444,  419, 443,  420, 444,  419, 1307,  419,  443,  420, 443,
    420,  1307, 420, 444,   419,  443,  420, 443,  420, 443,  420, 443,   420,  443,  420, 443,
    420,  443,  420, 444,   419,  443,  420, 1308, 418, 1307, 420, 1307,  419,  1307, 419, 1307,
    419,  1308, 418, 1307,  419,  444,  419, 1307, 419, 1305, 422, 1307,  419,  1307, 419, 444,
    419,  444,  419, 444,   419,  443,  420, 444,  419, 443,  420, 443,   420,  443,  420, 444,
    419,  444,  419, 443,   420,  444,  419, 444,  419, 1307, 420, 1307,  419,  444,  419, 443,
    420,  444,  419, 443,   420,  443,  420, 444,  419, 444,  419, 443,   420,  444,  419, 443,
    420,  1307, 420, 1306,  420,  443,  420, 443,  420, 443,  420, 444,   419,  443,  420, 444,
    419,  444,  419, 443,   420,  443,  420, 444,  419, 444,  419, 443,   420,  444,  419, 444,
    419,  443,  420, 443,   420,  444,  419, 444,  419, 444,  419, 443,   420,  443,  420, 444,
    419,  443,  420, 1307,  420,  1306, 421, 443,  420, 443,  420, 443,   420,  443,  420, 444,
    419,  443,  420, 444,   419,  443,  420, 444,  419, 443,  420, 443,   420,  443,  420, 444,
    419,  444,  419, 443,   420,  443,  420, 1308, 419, 1307, 419, 443,   420,  443,  420, 444,
    419,  1307, 420, 443,   420,  444,  419};
static uint32_t ir_20_raw[] = {
    446,  416,  446, 417,   446,  417,  446, 416,  447, 416,  447, 25404, 3422, 1759, 447, 1280,
    447,  415,  448, 417,   446,  417,  446, 1279, 448, 416,  447, 416,   447,  416,  447, 415,
    448,  1280, 447, 416,   447,  1279, 448, 1278, 448, 416,  447, 1280,  447,  1280, 446, 1280,
    447,  1280, 447, 1279,  447,  416,  447, 417,  446, 1278, 449, 416,   447,  417,  446, 417,
    446,  417,  446, 416,   447,  415,  448, 416,  447, 416,  447, 417,   446,  416,  447, 1279,
    448,  416,  447, 1281,  446,  415,  448, 416,  447, 415,  448, 1280,  447,  1280, 446, 415,
    448,  416,  447, 416,   447,  416,  447, 416,  447, 417,  446, 417,   446,  416,  447, 415,
    448,  417,  446, 417,   446,  416,  447, 417,  446, 415,  448, 416,   447,  416,  447, 1279,
    448,  1279, 448, 1280,  446,  416,  447, 1281, 446, 416,  447, 1280,  446,  1279, 447, 34849,
    3421, 1760, 446, 1281,  445,  417,  446, 415,  448, 416,  447, 1280,  447,  416,  447, 416,
    447,  416,  447, 416,   447,  1280, 447, 416,  447, 1280, 447, 1280,  446,  416,  447, 1280,
    447,  1280, 446, 1280,  447,  1279, 447, 1279, 447, 415,  448, 416,   447,  1280, 447, 416,
    446,  416,  447, 416,   447,  416,  447, 416,  447, 416,  447, 415,   448,  417,  446, 416,
    447,  416,  447, 416,   447,  1279, 448, 415,  448, 416,  447, 416,   447,  415,  448, 1280,
    447,  416,  447, 416,   447,  417,  446, 416,  447, 416,  447, 416,   447,  417,  446, 416,
    447,  416,  447, 416,   447,  416,  447, 417,  446, 416,  447, 416,   447,  416,  447, 416,
    447,  416,  447, 416,   447,  416,  447, 1279, 448, 416,  447, 1280,  447,  416,  447, 1280,
    447,  416,  447, 34850, 3420, 1760, 446, 1280, 446, 417,  446, 416,   447,  416,  447, 1279,
    448,  416,  447, 416,   447,  416,  447, 417,  446, 1280, 447, 416,   447,  1281, 446, 1279,
    447,  416,  447, 1280,  447,  1279, 447, 1280, 446, 1280, 446, 1279,  447,  415,  448, 416,
    447,  1280, 447, 416,   447,  417,  446, 416,  447, 416,  447, 416,   447,  416,  447, 416,
    447,  417,  446, 417,   446,  417,  446, 415,  448, 416,  447, 417,   446,  416,  447, 416,
    447,  417,  446, 417,   446,  416,  447, 1280, 447, 416,  447, 416,   447,  1279, 448, 1280,
    446,  1280, 446, 416,   447,  416,  447, 416,  447, 417,  446, 416,   447,  1280, 447, 416,
    447,  1279, 448, 415,   448,  416,  447, 416,  447, 416,  447, 416,   447,  417,  446, 416,
    447,  417,  446, 416,   447,  416,  447, 1279, 448, 1280, 446, 1279,  448,  1280, 446, 1280,
    447,  1280, 446, 1280,  447,  415,  448, 1279, 448, 1279, 448, 1279,  447,  1278, 448, 416,
    447,  416,  447, 416,   447,  416,  447, 416,  447, 416,  447, 416,   447,  416,  447, 416,
    447,  416,  447, 416,   447,  416,  447, 417,  446, 1279, 448, 1279,  448,  416,  447, 416,
    447,  416,  447, 417,   446,  416,  447, 416,  447, 416,  447, 417,   446,  417,  446, 416,
    447,  1280, 447, 1279,  447,  416,  447, 417,  446, 416,  447, 416,   447,  417,  446, 416,
    447,  416,  447, 416,   447,  416,  447, 416,  447, 416,  447, 416,   447,  416,  447, 416,
    447,  415,  448, 417,   446,  416,  447, 416,  447, 416,  447, 416,   447,  416,  447, 416,
    447,  417,  446, 1279,  448,  1279, 447, 416,  447, 416,  447, 416,   447,  416,  447, 415,
    448,  416,  447, 416,   447,  416,  447, 416,  447, 416,  447, 417,   446,  416,  447, 416,
    447,  416,  447, 416,   447,  416,  447, 1280, 447, 1280, 447, 1280,  446,  416,  447, 417,
    446,  1280, 447, 416,   446,  417,  446};
static uint32_t ir_22_raw[] = {
    444,  417,  445, 419,   444,  418,  445, 419,  444, 417,  446, 25406, 3421, 1759, 446, 1281,
    446,  417,  446, 417,   446,  418,  445, 1282, 445, 417,  446, 417,   446,  417,  446, 417,
    446,  1281, 446, 418,   445,  1281, 446, 1281, 445, 418,  445, 1281,  445,  1281, 446, 1281,
    446,  1281, 445, 1282,  445,  417,  446, 418,  445, 1281, 446, 416,   447,  419,  444, 418,
    445,  418,  445, 417,   446,  417,  446, 418,  445, 417,  446, 418,   445,  418,  445, 1282,
    445,  417,  446, 1282,  445,  417,  446, 417,  446, 418,  445, 1281,  446,  1281, 446, 417,
    446,  418,  445, 418,   445,  417,  446, 417,  446, 418,  445, 418,   445,  417,  446, 417,
    446,  417,  446, 417,   446,  417,  446, 418,  445, 417,  446, 417,   446,  419,  444, 1281,
    446,  1281, 446, 1282,  444,  417,  446, 1281, 446, 417,  446, 1281,  446,  1280, 446, 34850,
    3421, 1759, 446, 1280,  447,  417,  446, 417,  446, 417,  446, 1280,  447,  417,  446, 417,
    446,  417,  446, 417,   446,  1281, 446, 417,  446, 1280, 447, 1281,  446,  416,  447, 1280,
    447,  1281, 446, 1280,  446,  1281, 446, 1281, 445, 417,  446, 417,   446,  1281, 446, 416,
    447,  418,  445, 418,   445,  418,  445, 416,  447, 417,  446, 417,   446,  417,  446, 418,
    445,  417,  446, 418,   445,  1281, 446, 416,  447, 417,  446, 418,   445,  417,  446, 1281,
    446,  416,  447, 417,   446,  417,  446, 417,  446, 418,  445, 418,   445,  418,  445, 418,
    445,  417,  446, 417,   446,  418,  445, 416,  447, 417,  446, 417,   446,  418,  445, 417,
    446,  417,  446, 417,   446,  417,  446, 1280, 447, 417,  446, 1281,  446,  417,  446, 1281,
    446,  417,  446, 34850, 3421, 1759, 446, 1281, 446, 416,  447, 416,   447,  417,  446, 1280,
    447,  416,  447, 417,   446,  417,  446, 417,  446, 1281, 446, 417,   446,  1280, 447, 1281,
    445,  417,  446, 1281,  446,  1279, 448, 1279, 447, 1280, 447, 1280,  446,  416,  447, 416,
    447,  1279, 448, 416,   447,  417,  446, 416,  447, 417,  446, 418,   445,  418,  445, 417,
    446,  417,  446, 418,   445,  416,  447, 418,  445, 417,  446, 416,   447,  416,  447, 416,
    447,  417,  446, 416,   447,  417,  446, 1281, 446, 417,  446, 417,   446,  1282, 445, 1280,
    446,  1280, 447, 417,   446,  416,  447, 418,  445, 417,  446, 1280,  447,  1281, 446, 417,
    446,  1281, 446, 417,   446,  416,  447, 417,  446, 416,  447, 417,   446,  418,  445, 417,
    446,  416,  447, 417,   446,  417,  446, 1282, 445, 1281, 445, 1280,  446,  1280, 447, 1282,
    444,  1280, 446, 1281,  446,  417,  446, 1281, 446, 1280, 447, 1280,  447,  1281, 445, 418,
    445,  417,  446, 417,   446,  417,  446, 417,  446, 418,  445, 417,   446,  418,  445, 418,
    445,  417,  446, 416,   447,  418,  445, 418,  445, 1281, 446, 1281,  445,  417,  446, 418,
    445,  417,  446, 418,   445,  417,  446, 417,  446, 417,  446, 417,   446,  418,  445, 417,
    446,  1281, 446, 1281,  445,  417,  446, 417,  446, 417,  446, 418,   445,  416,  447, 417,
    446,  418,  445, 416,   447,  416,  447, 417,  446, 417,  446, 417,   446,  417,  446, 417,
    446,  418,  445, 417,   446,  417,  446, 417,  446, 417,  446, 418,   445,  417,  446, 417,
    446,  417,  446, 1281,  446,  1281, 446, 417,  446, 417,  446, 417,   446,  418,  445, 418,
    445,  418,  445, 418,   445,  417,  446, 418,  445, 418,  445, 417,   446,  417,  446, 417,
    446,  417,  446, 416,   447,  416,  447, 1281, 446, 1280, 447, 417,   446,  1281, 446, 417,
    446,  1281, 446, 418,   445,  418,  445};
static uint32_t ir_24_raw[] = {
    445,  417,  420, 444,   445,  417,  446, 417,  446, 416,  447, 25406, 3420, 1758, 448, 1280,
    447,  416,  446, 417,   446,  415,  448, 1280, 447, 416,  446, 417,   446,  416,  447, 416,
    447,  1280, 447, 416,   447,  1280, 447, 1280, 446, 417,  446, 1281,  446,  1281, 445, 1281,
    445,  1280, 447, 1281,  446,  417,  446, 417,  446, 1281, 446, 415,   448,  416,  447, 416,
    447,  417,  446, 417,   446,  416,  447, 417,  446, 416,  447, 416,   447,  416,  447, 1281,
    446,  416,  447, 1280,  447,  417,  446, 417,  446, 417,  446, 1280,  447,  1281, 446, 417,
    446,  416,  447, 416,   447,  416,  447, 416,  447, 417,  446, 416,   447,  417,  446, 416,
    447,  416,  447, 417,   446,  417,  446, 417,  446, 416,  447, 417,   446,  416,  447, 1279,
    448,  1281, 445, 1279,  448,  416,  447, 1281, 446, 416,  447, 1280,  447,  1279, 448, 34849,
    3421, 1759, 447, 1281,  445,  416,  447, 416,  447, 417,  446, 1280,  447,  416,  447, 415,
    448,  416,  447, 416,   447,  1280, 447, 416,  447, 1280, 447, 1280,  447,  416,  447, 1279,
    448,  1280, 446, 1281,  446,  1280, 446, 1280, 446, 416,  447, 416,   447,  1280, 447, 416,
    447,  416,  447, 417,   446,  416,  447, 417,  446, 416,  447, 416,   447,  417,  446, 417,
    446,  416,  447, 415,   448,  1280, 447, 416,  447, 416,  447, 415,   448,  416,  447, 1279,
    448,  416,  447, 416,   447,  417,  446, 417,  446, 416,  447, 416,   447,  416,  447, 417,
    446,  417,  446, 416,   447,  416,  447, 416,  447, 416,  447, 417,   446,  417,  446, 417,
    446,  416,  447, 416,   447,  417,  446, 1280, 447, 416,  446, 1281,  446,  416,  447, 1282,
    445,  416,  447, 34849, 3421, 1759, 446, 1281, 446, 417,  446, 417,   446,  417,  420, 1306,
    447,  417,  419, 442,   447,  417,  446, 416,  447, 1280, 447, 416,   447,  1281, 446, 1280,
    447,  416,  447, 1281,  446,  1280, 447, 1280, 446, 1279, 448, 1280,  446,  416,  447, 417,
    446,  1280, 447, 416,   447,  417,  446, 417,  446, 417,  446, 417,   446,  417,  446, 417,
    446,  418,  445, 416,   447,  416,  447, 417,  446, 417,  446, 415,   448,  417,  446, 417,
    446,  417,  446, 418,   445,  417,  446, 1280, 447, 416,  447, 417,   446,  1279, 448, 1279,
    447,  1280, 447, 416,   447,  417,  420, 443,  446, 417,  446, 417,   446,  416,  447, 1280,
    447,  1281, 445, 416,   447,  417,  446, 417,  446, 417,  446, 417,   420,  443,  446, 416,
    447,  417,  446, 417,   446,  416,  447, 1279, 448, 1280, 446, 1280,  447,  1281, 445, 1279,
    448,  1280, 446, 1279,  448,  417,  419, 1307, 446, 1280, 447, 1280,  446,  1280, 446, 416,
    447,  417,  446, 417,   446,  417,  446, 417,  446, 417,  446, 416,   447,  417,  446, 417,
    446,  417,  446, 417,   446,  417,  446, 416,  447, 1281, 446, 1280,  447,  417,  445, 417,
    446,  416,  447, 417,   446,  417,  446, 417,  446, 416,  447, 416,   447,  416,  447, 416,
    447,  1280, 447, 1280,  447,  416,  447, 417,  446, 417,  446, 417,   446,  417,  446, 417,
    446,  416,  447, 417,   446,  416,  447, 417,  446, 416,  447, 416,   447,  416,  447, 416,
    447,  416,  447, 416,   447,  416,  447, 416,  447, 417,  446, 416,   447,  416,  447, 417,
    446,  416,  447, 1280,  447,  1280, 446, 417,  446, 416,  447, 416,   447,  417,  446, 417,
    446,  416,  447, 416,   447,  416,  447, 417,  446, 416,  447, 416,   447,  416,  447, 417,
    446,  416,  447, 416,   447,  416,  447, 1280, 447, 1279, 448, 1280,  447,  1279, 447, 416,
    447,  1280, 447, 416,   447,  416,  447};
static uint32_t ir_dehum_raw[] = {
    420,  443,  420, 441,   422,  441,  422, 442,  421, 442,  421, 25429, 3422, 1757, 423, 1304,
    422,  440,  423, 442,   421,  441,  422, 1304, 423, 441,  422, 441,   422,  442,  421, 441,
    422,  1304, 423, 441,   422,  1304, 423, 1306, 420, 440,  423, 1306,  421,  1304, 423, 1305,
    422,  1304, 422, 1305,  422,  440,  423, 441,  422, 1304, 423, 441,   422,  440,  423, 441,
    422,  441,  422, 441,   422,  442,  421, 441,  422, 444,  419, 441,   422,  441,  422, 1304,
    423,  441,  422, 1305,  422,  441,  422, 442,  421, 441,  422, 1305,  422,  1305, 421, 442,
    421,  441,  422, 441,   422,  442,  421, 441,  422, 442,  421, 441,   422,  441,  422, 439,
    424,  441,  422, 440,   423,  440,  423, 441,  422, 441,  422, 441,   422,  441,  422, 1304,
    423,  1306, 420, 1305,  422,  441,  422, 1305, 422, 441,  422, 1304,  423,  1305, 422, 34874,
    3422, 1756, 424, 1305,  422,  440,  423, 440,  423, 441,  422, 1304,  423,  440,  423, 442,
    421,  441,  422, 442,   421,  1304, 423, 440,  423, 1306, 421, 1304,  423,  439,  424, 1305,
    422,  1304, 422, 1304,  422,  1305, 422, 1304, 422, 440,  423, 441,   422,  1305, 422, 440,
    423,  441,  422, 441,   422,  441,  422, 441,  422, 441,  422, 442,   421,  441,  422, 442,
    421,  441,  422, 441,   422,  1305, 422, 440,  423, 442,  421, 441,   422,  440,  423, 1304,
    423,  440,  423, 442,   421,  440,  423, 441,  422, 440,  423, 440,   423,  441,  422, 442,
    421,  442,  421, 441,   422,  442,  421, 442,  421, 442,  421, 442,   421,  441,  422, 441,
    422,  445,  418, 440,   423,  442,  421, 1305, 422, 441,  422, 1304,  423,  441,  422, 1304,
    423,  440,  423, 34873, 3423, 1757, 422, 1306, 421, 441,  422, 441,   422,  441,  422, 1304,
    423,  440,  423, 442,   421,  441,  422, 442,  421, 1305, 422, 441,   422,  1304, 423, 1305,
    422,  442,  421, 1304,  423,  1304, 422, 1304, 422, 1304, 423, 1304,  422,  441,  422, 442,
    421,  1305, 422, 440,   423,  442,  421, 442,  421, 441,  422, 441,   422,  441,  422, 442,
    421,  440,  423, 440,   423,  441,  422, 441,  422, 441,  422, 441,   422,  441,  422, 441,
    422,  441,  422, 442,   421,  441,  422, 1305, 422, 440,  423, 441,   422,  1305, 422, 441,
    422,  1305, 422, 440,   423,  442,  421, 442,  421, 441,  422, 442,   421,  441,  422, 440,
    423,  441,  422, 1305,  422,  1304, 422, 440,  423, 442,  421, 442,   421,  441,  422, 440,
    423,  441,  422, 441,   422,  441,  422, 1306, 421, 1305, 422, 1305,  422,  1304, 422, 441,
    422,  1305, 422, 441,   422,  1305, 422, 1304, 422, 1305, 421, 1304,  422,  1304, 423, 441,
    422,  440,  423, 443,   420,  442,  421, 441,  422, 442,  421, 441,   422,  441,  422, 441,
    422,  441,  422, 442,   421,  440,  423, 441,  422, 1304, 423, 1305,  421,  441,  422, 442,
    421,  441,  422, 441,   422,  441,  422, 441,  422, 440,  423, 442,   421,  442,  421, 441,
    422,  1304, 423, 1304,  422,  441,  422, 441,  422, 442,  421, 441,   422,  441,  422, 441,
    422,  441,  422, 441,   422,  441,  422, 442,  421, 442,  421, 441,   422,  441,  422, 441,
    422,  441,  422, 442,   421,  441,  422, 443,  420, 440,  423, 442,   421,  441,  422, 441,
    422,  442,  421, 1304,  423,  1304, 423, 441,  422, 440,  423, 442,   421,  442,  421, 441,
    422,  441,  422, 441,   422,  441,  422, 441,  422, 441,  422, 441,   422,  442,  421, 442,
    421,  442,  421, 442,   421,  441,  422, 1304, 423, 1304, 422, 1304,  423,  1304, 422, 1305,
    422,  439,  424, 1305,  422,  1304, 422

};

#define IR_FREQ 38000
#define IR_DUTY 0.33f

void send_my_signal(uint32_t signal[], size_t size) {
    infrared_send_raw_ext(signal, size, true, IR_FREQ, IR_DUTY);
}

// Handle user input for main grid: navigation, selection, and sending IR codes
static void input_callback(InputEvent* event, void* ctx) {
    bool* running = ctx;

    if(event->type == InputTypeLong && event->key == InputKeyBack) {
        *running = false; // Long press Back to exit app
        return;
    }

    // Holding the OK button will turn off the AC
    if(event->type == InputTypeLong && event->key == InputKeyOk) {
        send_my_signal(ir_off_raw, sizeof(ir_off_raw) / sizeof(ir_off_raw[0]));
    }

    // Ignore events other than short press for navigation
    if(event->type != InputTypeShort) {
        return;
    }

    if(event->key == InputKeyOk) {
        if(selected_row == 0) {
            if(selected_col == 0) {
                send_my_signal(ir_dehum_raw, sizeof(ir_dehum_raw) / sizeof(ir_dehum_raw[0]));
                return;
            }

            if(selected_col == 1) {
                send_my_signal(ir_20_raw, sizeof(ir_20_raw) / sizeof(ir_20_raw[0]));
                return;
            }

            if(selected_col == 2) {
                send_my_signal(ir_24_raw, sizeof(ir_24_raw) / sizeof(ir_24_raw[0]));
                return;
            }
        }

        if(selected_row == 1) {
            //send power
            if(selected_col == 0) {
                send_my_signal(ir_on_raw, sizeof(ir_on_raw) / sizeof(ir_on_raw[0]));
                return;
            }

            if(selected_col == 1) {
                send_my_signal(ir_18_raw, sizeof(ir_18_raw) / sizeof(ir_18_raw[0]));
                return;
            }

            if(selected_col == 2) {
                send_my_signal(ir_22_raw, sizeof(ir_22_raw) / sizeof(ir_22_raw[0]));
                return;
            }
        }
    }

    switch(event->key) {
    case InputKeyLeft:
        if(selected_col > 0) selected_col--;
        break;

    case InputKeyRight:
        if(selected_col < GRID_COLS - 1) selected_col++;
        break;

    case InputKeyUp:
        if(selected_row > 0) selected_row--;
        break;

    case InputKeyDown:
        if(selected_row < GRID_ROWS - 1) selected_row++;
        break;

    default:
        break;
    }
}

//entry point
int32_t airconditioning_app(void* p) {
    UNUSED(p);

    bool running = true;

    Gui* gui = furi_record_open("gui");

    ViewPort* viewport = view_port_alloc();

    view_port_draw_callback_set(viewport, draw_callback, NULL);
    view_port_input_callback_set(viewport, input_callback, &running);

    gui_add_view_port(gui, viewport, GuiLayerFullscreen);

    while(running) {
        furi_delay_ms(50);
    }

    // Cleanup resources before exit
    gui_remove_view_port(gui, viewport);
    view_port_free(viewport);
    furi_record_close("gui");

    return 0;
}
